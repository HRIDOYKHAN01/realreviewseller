(()=>{var H;const T=document.currentScript;if(!T)return;let L=!1,E=!1;const i=T.attributes,Q=((H=i.getNamedItem("src"))==null?void 0:H.nodeValue)||{}.VITE_WIDGET_SRC,h=new URL(Q).origin,N="https://api.cxgenie.ai/api",_=async()=>{var A,G,U,z,F,J,q,K;const c=(A=i.getNamedItem("data-aid"))==null?void 0:A.nodeValue,W=(G=i.getNamedItem("data-lang"))==null?void 0:G.nodeValue,j=((U=i.getNamedItem("data-token"))==null?void 0:U.nodeValue)||"",D=((z=i.getNamedItem("data-user-id"))==null?void 0:z.nodeValue)||"",V=((F=i.getNamedItem("data-email"))==null?void 0:F.nodeValue)||"",B=((J=i.getNamedItem("data-phone-number"))==null?void 0:J.nodeValue)||"",r=JSON.parse(((q=i.getNamedItem("data-mobile"))==null?void 0:q.nodeValue)||"false"),M=((K=i.getNamedItem("data-hide-widget-button"))==null?void 0:K.nodeValue)||"",C=document.createElement("link");C.rel="stylesheet",C.href=`${h}/widget.css`,document.head.appendChild(C);const x=document.createElement("meta");if(x.name="viewport",x.content="width=device-width, initial-scale=1.0 user-scalable=no",document.head.appendChild(x),!c)return;const X=await fetch(`${N}/v1/bots/public/${c}`).then(e=>e.json()).then(e=>e.data).catch(e=>null);if(!X)return;const{chat_widget_icon:b,auto_open_chat_in_web:Z,theme_color:ee,is_widget_draggable:te,widget_position:ne}=X,o=document.createElement("object"),oe=new URLSearchParams({...c&&{"agent-id":c},...j&&{"user-token":j},...D&&{"user-id":D},...V&&{"user-email":V},...B&&{"user-phone-number":B},...r&&{"is-mobile":r},...W&&{lang:W},origin:window.origin}),R=`${h}?${oe.toString()}`;o.className=`cxgenie-chat-modal ${r?"mobile open":""} ${M?"hide-button":""}`,o.data=R,o.ariaLabel="Chat modal";const t=document.createElement("div");t.id="cxgenie-chat-button",t.className=`cxgenie-chat-button ${ne}`,t.innerHTML=b?`<img src="${b}" width="100%" height="100%" style="border-radius: 100%; object-fit: cover;" />`:`<img src='${h}/document-icon.svg' class="document-icon" />`,o.addEventListener("error",()=>{o.data="",setTimeout(()=>{o.data=R},1e3)});let S=!0;if(te){let e=function(n){return n instanceof TouchEvent&&n.touches.length>0?{x:n.touches[0].clientX,y:n.touches[0].clientY}:{x:n.clientX,y:n.clientY}},s=function(n){u=!0,S=!0;const{x:p,y:w}=e(n);g=p,f=w,v=p-t.offsetLeft,y=w-t.offsetTop,n.preventDefault()},a=function(n){if(u){d();const{x:p,y:w}=e(n);let $=p-v,I=w-y;$=Math.max(0,Math.min($,window.innerWidth-t.offsetWidth)),I=Math.max(0,Math.min(I,window.innerHeight-t.offsetHeight)),t.style.left=$+"px",t.style.top=I+"px",Y();const de=Math.abs(p-g),le=Math.abs(w-f);(de>l||le>l)&&(S=!1)}n.preventDefault()},m=function(n){u&&t.click(),u=!1,n.preventDefault()},u=!1,g,f,v,y;const l=5;t.addEventListener("mousedown",s),document.addEventListener("mousemove",a),document.addEventListener("mouseup",m),t.addEventListener("touchstart",s),t.addEventListener("touchmove",a),t.addEventListener("touchend",m)}function Y(){const e=t.getBoundingClientRect(),s=400,a=490,m=20,u=40,g=window.innerWidth-e.right,f=window.innerHeight-e.bottom,v=e.left,y=e.top;let l,n;g>=s?l=g-s-m:v>=s?l=window.innerWidth-e.left+m:l=Math.max(window.innerWidth-s-10,10),f>=a?n=f-a+u+m:y>=a?n=window.innerHeight-e.bottom-a-10:n=Math.max(window.innerHeight-a-10,10),o.style.right=`${Math.max(l,10)}px`,o.style.bottom=`${Math.max(n,10)}px`}const O=()=>{document.documentElement.classList.add("disable-scroll")},P=()=>{document.documentElement.classList.remove("disable-scroll")},k=()=>{setTimeout(()=>{M||Y(),o.classList.add("open"),L=!0,t.innerHTML=`<img src='${h}/close-icon.svg' class="close-icon" />`,E&&O()},0)},d=()=>{o.classList.remove("open"),P(),L=!1,t.innerHTML=b?`<img src="${b}" width="100%" height="100%" style="border-radius: 100%; object-fit: cover;" />`:`<img src='${h}/document-icon.svg' class="document-icon" />`},ae=()=>{o.classList.add("fullscreen"),E=!0,O()},ie=()=>{o.classList.remove("fullscreen"),E=!1,P()};window.openCXGenieChatWidget=k,window.closeCXGenieChatWidget=d,window.addEventListener("message",e=>{switch(e.data){case"closeChatModal":{d();break}case"openChatData":{d();break}case"fullscreenMode":{ae();break}case"windowMode":{ie();break}}});const se=()=>{const e=window.innerHeight;document.documentElement.style.setProperty("--dvh",`${e}px`)};window.addEventListener("resize",se),t.onclick=()=>{S&&(L?d():k())};const ce=(e,s)=>{document.addEventListener("click",a=>{e.contains(a.target)||s()})};if(document.addEventListener("keydown",e=>{e.code==="Escape"&&d()}),r||ce(o,d),r||localStorage.getItem("cx-track-botid")!==c&&(localStorage.setItem("cx-track-botid",c),fetch(`${N}/v1/sites`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({bot_id:c,domain:window.origin})}).catch(e=>{})),t.style.background=ee||"#364de7",t.classList.add("open"),r){const e=document.createElement("div");e.style.width="100vw",e.style.height="100vh",e.style.overflow="hidden",e.appendChild(o),document.body.appendChild(e),document.body.classList.add("mobile")}else document.body.appendChild(o),M||document.body.append(t);Z&&k()};document.readyState==="complete"?_():document.addEventListener("readystatechange",()=>{document.readyState==="complete"&&_()})})();